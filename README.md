## ****«Протоколы транспортного уровня: TCP, UDP»**** ##


***Задание Firewall***

`Firewall` (межсетевой экран) - это устройство или программный продукт (есть разные исполнения), которое просматривает входящий и исходящий трафик и на основании определённых правил безопасности принимает решения о том, пропустить данный трафик (к сети, хосту или приложениям хоста) или нет.

В рамках данной работы сделаем базовые настройки МЭ для Linux.

Для выполнения этого задания потребуются две виртуальные машины: Ubuntu и Kali

Выполнение:

- Для установки на машине с Kali выполните следующие команды:

~~~sudo apt update
sudo apt install telnet
~~~

- Запустим виртуальную машину Ubuntu и установим следующие программы:

~~~
sudo apt update
sudo apt install nginx openssh-server vsftpd telnet
~~~

`nginx` - веб-сервер (возможность публикации веб-страниц)

`openssh-server` - сервер ssh (Secure Shell - возможность управления с использованием интерпретатора команд на удалённом сервере)

`vsftpd` - сервер ftp (File Transfer Protocol - протокол передачи файлов)

- Установленные приложения запустятся после установки сразу в виде сервисов и откроют следующие порты:

`nginx` откроет порт 80

`openssh` - server откроет порт 22

`vsftpd` откроет порт 21

По умолчанию в режиме NAT каждая VM работает изолированно. Поэтому нам необходимо внести некоторые изменения.

1. Настройте виртуальные машины согласнов видео (Ubuntu - 192.168.0.1, Kali - 192.168.0.2)

2. Проверьте, что всё работает, с помощью утилиты ping (обе VM должны быть запущены)

3. Запустите виртуальную машину Kali

4. Проверьте доступность сервисов, для этого воспользуйтесь программой telnet

О программе telnet
Нам поступила задача закрыть FTP для доступа из сети, оставив открытыми только 80 и 22 порты. Для этого воспользуемся МЭ, входящим в состав Ubuntu и закроем доступ.

1. Перейдите в Ubuntu:

2. Введите команду:
~~~
ubuntu@ubuntu:~$ sudo ufw status verbose
Status: inactive

#Это означает, что МЭ выключен
~~~


3. Включите МЭ:
~~~
ubuntu@ubuntu:~$ sudo ufw enable
Firewall is active and enabled on system startup
(для отключения нужно ввести команду: sudo ufw disable)
~~~
4. Теперь МЭ работает, чтобы убедиться в этом, перейдите в Kali и повторите запросы telnet:
~~~
telnet 192.168.0.1 80

telnet 192.168.0.1 22

telnet 192.168.0.1 21
~~~
На все ваши попытки должен быть получен следующий ответ:
~~~
Trying 192.168.0.1...
Т.е. соединение не устанавливается.
~~~
![ufw](https://github.com/PopChop88/Transport-layer-protocols-TCP-UDP/blob/main/рис/Screenshot_1.png?raw=true)

5. Перейдите в Ubuntu и выполните следующие команды:
~~~
# разрешение http (порт 80)
ubuntu@ubuntu:~$ sudo ufw allow http
Rule added
Rule added (v6)

# разрешение ssh (порт 22)
ubuntu@ubuntu:~$ sudo ufw allow ssh
Rule added
Rule added (v6)
~~~
![ufw](https://github.com/PopChop88/Transport-layer-protocols-TCP-UDP/blob/main/рис/Screenshot_2.png?raw=true)

6. Вернитесь в Kali и проверьте команды telnet:
~~~
kali@kali:~$ telnet 192.168.0.1 80
Trying 192.168.0.1...
Connected to 192.168.0.1.
Escape character is '^]'.
^]
telnet> q
Connection closed.

kali@kali:~$ telnet 192.168.0.1 22
Trying 192.168.0.1...
Connected to 192.168.0.1.
Escape character is '^]'.
SSH-2.0-OpenSSH_7.6p1 Ubuntu-4ubuntu0.3
^]
telnet> q
Connection closed.
Попытка подключения к 21 порту закончится безуспешно.
~~~

По умолчанию применяется правило "всё, что явно не разрешено - запрещено".

